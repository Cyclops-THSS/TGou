{# 定义 CartEditJSON：表示用户对购物车的编辑，字符串，以JSON解释， #}
{#     javascript 字典(key-value pairs)，key为商品id，value为数量 #}
{#     如 `{233: 3, 234: 2, 235:5}` 表示购物车中目前有233号商品3件，...  #}
{#     如 `{233: 2, 234: 2, 235:0}` 表示用户把233号商品改成了2件，并从购物车中删除了235号商品 #}

{# POST 到自己 #}
{#      whatamidoing: submit提交生成订单 / save暂存 #}
{#      cartJson: 上述定义的CartEditJSON：JSON字符串 #}

{# POST 到 clear，无参数 #}

{# 接受的模板参数 #}
{#      cart，常规Python对象 #}
{#      cartJson，上述定义的CartEditJSON：JSON字符串 #}


{% extends "base.html" %}
{% load i18n %}
{% load mathfilters %}
{% block content %}


<h1>您的购物车</h1>

<p>包含以下商品：</p>
<table class="order-items">
	<tr>
		<th>商品</th>
		<th>店铺</th>
		<th>数量</th>
		<th>单价</th>
		<th>小计</th>
		<th>操作</th>
	</tr>
{% for cartitem in cart.cartitem_set.all %}
	<tr>
		<td><span class="commodity-name">
				{{ cartitem.commodity.name }} (#{{ cartitem.commodity.id }})</span></td>
		<td><span class="shop-name">
						{{ cartitem.commodity.shop.name }} (#{{ cartitem.commodity.shop.id }})</span></td>
		<td>
			<span class="quantity"><input class="quantity-box" value="{{ cartitem.quantity }}"/></span></td>
		<td><span class="price">
			{{ cartitem.commodity.price }}</span></td>
		<td><span class="price">
			{{ cartitem.commodity.price|mul:cartitem.quantity }}</span></td>
		<td>
			<button class="cartitem-remove" onclick="item_remove(this)">删除</button>
		</td>
	</tr>
{% endfor %}
	<tr>
		<td>
			总价格</td>
		<td></td>
		<td></td>
		<td></td>
		<td><span class="price">
			{{ cart.price }}</span></td>
		<td></td>
	</tr>
</table>

<form method="post" action="" id="form">
	<input name="whatamidoing" type="hidden" value=""/>
	<input name="cartitems" type="hidden" value=""/>
	<button type="button" class="cart-save" onclick="cart_save()">暂存更改</button>
	<button type="button" class="cart-submit" onclick="cart_submit()">前去结算</button>
</form>

<form method="post" action="clear">
	<button type="submit" class="clear-cart">清空购物车</button>
</form>


<script>
	function item_remove(el){

	}
	function cart_save(el){

	}
	function cart_submit(el){

	}
	function get_cart_items(){

	}
</script>



{% endblock %}
